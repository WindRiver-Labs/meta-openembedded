From f152c1268f28fc84d15d364b742f500e12374b33 Mon Sep 17 00:00:00 2001
From: Denis Ovsienko <denis@ovsienko.info>
Date: Sun, 15 Jan 2017 13:50:17 +0000
Subject: [PATCH] CVE-2017-5485/add the test case

---
 tests/TESTLIST                    |    1 +
 tests/isoclns-heapoverflow-3.out  |    1 +
 tests/isoclns-heapoverflow-3.pcap |  Bin 0 -> 152 bytes
 3 files changed, 2 insertions(+)
 create mode 100644 tests/isoclns-heapoverflow-3.out
 create mode 100644 tests/isoclns-heapoverflow-3.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index bf84aa0..7b487e0 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -333,6 +333,7 @@ atm-heapoverflow	atm-heapoverflow.pcap		atm-heapoverflow.out		-t -c1 -e
 snmp-heapoverflow-1	snmp-heapoverflow-1.pcap	snmp-heapoverflow-1.out		-t
 snmp-heapoverflow-2	snmp-heapoverflow-2.pcap	snmp-heapoverflow-2.out		-t
 isoclns-heapoverflow-2	isoclns-heapoverflow-2.pcap	isoclns-heapoverflow-2.out	-t -e -c1
+isoclns-heapoverflow-3	isoclns-heapoverflow-3.pcap	isoclns-heapoverflow-3.out	-t -e -c1
 
 # RTP tests
 # fuzzed pcap
diff --git a/tests/isoclns-heapoverflow-3.out b/tests/isoclns-heapoverflow-3.out
new file mode 100644
index 0000000..74d2a22
--- /dev/null
+++ b/tests/isoclns-heapoverflow-3.out
@@ -0,0 +1 @@
+fe:fe:fe:fe:fe:fe > 30:30:da:fe:fe:fe, ethertype OSI (0xfefe), length 808464432: OSI NLPID CLNP (0x81): 00 > e8.3030, Echo Request, length 808464417
diff --git a/tests/isoclns-heapoverflow-3.pcap b/tests/isoclns-heapoverflow-3.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..1425bdbc14d48cb2e7f05c151079ba3b03f3691c
GIT binary patch
literal 152
zcmca|c+)~A1{MYbD9~bHU|<Ad0S1tetwA1;4UxL_4+%8>VFd9Q7?@ue7%;+h8wA13
U!Arx<M5tmgaB^Y>io=Wo0O4yWv;Y7A

literal 0
HcmV?d00001

-- 
1.7.9.5

