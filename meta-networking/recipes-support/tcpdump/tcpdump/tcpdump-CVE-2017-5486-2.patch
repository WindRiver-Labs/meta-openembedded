From d07f72422772d435bcb1e756c7ea0831a2b76307 Mon Sep 17 00:00:00 2001
From: Denis Ovsienko <denis@ovsienko.info>
Date: Sun, 15 Jan 2017 13:35:33 +0000
Subject: [PATCH] CVE-2017-5486/add the test case

---
 tests/TESTLIST                    |    1 +
 tests/isoclns-heapoverflow-2.out  |    1 +
 tests/isoclns-heapoverflow-2.pcap |  Bin 0 -> 152 bytes
 3 files changed, 2 insertions(+)
 create mode 100644 tests/isoclns-heapoverflow-2.out
 create mode 100644 tests/isoclns-heapoverflow-2.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 8808a3f..bf84aa0 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -332,6 +332,7 @@ atm-heapoverflow	atm-heapoverflow.pcap		atm-heapoverflow.out		-t -c1 -e
 # bad packets from Kamil Frankowicz
 snmp-heapoverflow-1	snmp-heapoverflow-1.pcap	snmp-heapoverflow-1.out		-t
 snmp-heapoverflow-2	snmp-heapoverflow-2.pcap	snmp-heapoverflow-2.out		-t
+isoclns-heapoverflow-2	isoclns-heapoverflow-2.pcap	isoclns-heapoverflow-2.out	-t -e -c1
 
 # RTP tests
 # fuzzed pcap
diff --git a/tests/isoclns-heapoverflow-2.out b/tests/isoclns-heapoverflow-2.out
new file mode 100644
index 0000000..6bdfd01
--- /dev/null
+++ b/tests/isoclns-heapoverflow-2.out
@@ -0,0 +1 @@
+fe:fe:fe:fe:fe:fe > 30:30:da:fe:fe:fe, ethertype OSI (0xfefe), length 808464432: OSI NLPID CLNP (0x81): [|clnp]
diff --git a/tests/isoclns-heapoverflow-2.pcap b/tests/isoclns-heapoverflow-2.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..c86570be8609927164ec3add92547df664cac6ea
GIT binary patch
literal 152
zcmca|c+)~A1{MYbD9~bHU|<Ad0S1tetwA1;4UxL_4+%8>VFd9Q7?@ue7zn_18wA13
U!Arx<M5tmgaB^Y>io=Wo0OnUH!vFvP

literal 0
HcmV?d00001

-- 
1.7.9.5

