From 909fb30769e92d3f432b41d3eea3c0623bc03c84 Mon Sep 17 00:00:00 2001
From: Francois-Xavier Le Bail <fx.lebail@yahoo.com>
Date: Fri, 23 Dec 2016 22:11:18 +0100
Subject: [PATCH] CVE-2017-5202/ISOCLNS: Add two bounds checks

This fix GitHub issue #558
---
 print-isoclns.c |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/print-isoclns.c b/print-isoclns.c
index 0d63679..e507d54 100644
--- a/print-isoclns.c
+++ b/print-isoclns.c
@@ -798,11 +798,13 @@ clnp_print(netdissect_options *ndo,
 
         pptr += sizeof(struct clnp_header_t);
         li -= sizeof(struct clnp_header_t);
+	ND_TCHECK(*pptr);
         dest_address_length = *pptr;
         dest_address = pptr + 1;
 
         pptr += (1 + dest_address_length);
         li -= (1 + dest_address_length);
+	ND_TCHECK(*pptr);
         source_address_length = *pptr;
         source_address = pptr +1;
 
-- 
1.7.9.5

