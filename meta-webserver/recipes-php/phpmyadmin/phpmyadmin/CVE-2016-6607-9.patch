From 1ed4007689ebbb6b6a08a242025382d0f8d347b1 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>
Date: Sun, 10 Jul 2016 18:01:45 +0200
Subject: [PATCH] Properly escape MySQL status variables
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Michal Čihař <michal@cihar.com>
---
 libraries/replication_gui.lib.php         |    8 ++++----
 libraries/server_status_variables.lib.php |    2 +-
 2 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/libraries/replication_gui.lib.php b/libraries/replication_gui.lib.php
index d700bf4..d0d5dd2 100644
--- a/libraries/replication_gui.lib.php
+++ b/libraries/replication_gui.lib.php
@@ -548,7 +548,7 @@ function PMA_getHtmlForReplicationStatusTable($type, $hidden = false, $title = t
     foreach (${"{$type}_variables"} as $variable) {
         $html .= '   <tr class="' . ($odd_row ? 'odd' : 'even') . '">';
         $html .= '     <td class="name">';
-        $html .=        $variable;
+        $html .= htmlspecialchars($variable);
         $html .= '     </td>';
         $html .= '     <td class="value">';
 
@@ -571,13 +571,13 @@ function PMA_getHtmlForReplicationStatusTable($type, $hidden = false, $title = t
             'Replicate_Do_Table', 'Replicate_Ignore_Table',
             'Replicate_Wild_Do_Table', 'Replicate_Wild_Ignore_Table');
         if (in_array($variable, $variables_wrap)) {
-            $html .= str_replace(
+            $html .= htmlspecialchars(str_replace(
                 ',',
                 ', ',
                 ${"server_{$type}_replication"}[0][$variable]
-            );
+            ));
         } else {
-            $html .= ${"server_{$type}_replication"}[0][$variable];
+            $html .= htmlspecialchars(${"server_{$type}_replication"}[0][$variable]);
         }
         $html .= '</span>';
 
diff --git a/libraries/server_status_variables.lib.php b/libraries/server_status_variables.lib.php
index 98ab500..53b7ad4 100644
--- a/libraries/server_status_variables.lib.php
+++ b/libraries/server_status_variables.lib.php
@@ -284,7 +284,7 @@ function PMA_getHtmlForRenderVariables($ServerStatusData, $alerts, $strShowStatu
                 $retval .= '<span class="allfine">';
             }
         }
-        $retval .= $value;
+        $retval .= htmlspecialchars($value);
         if (isset($alerts[$name])) {
             $retval .= '</span>';
         }
-- 
1.7.9.5

