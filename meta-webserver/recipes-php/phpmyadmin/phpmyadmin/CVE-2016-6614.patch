From 5491d67fb545ef9878b59e05a10f814f7a92a7ad Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>
Date: Thu, 30 Jun 2016 10:04:46 +0200
Subject: [PATCH] Avoid possible path traversal using MySQL username
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Michal Čihař <michal@cihar.com>
---
 libraries/Util.php |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libraries/Util.php b/libraries/Util.php
index 8606f4d..bcef4f8 100644
--- a/libraries/Util.php
+++ b/libraries/Util.php
@@ -2692,7 +2692,7 @@ class Util
             $dir .= '/';
         }
 
-        return str_replace('%u', $GLOBALS['cfg']['Server']['user'], $dir);
+        return str_replace('%u', PMA_securePath($GLOBALS['cfg']['Server']['user']), $dir);
     }
 
     /**
-- 
1.7.9.5

