From 7e510e8e92b33493aded0086c0b87d8ed7bdec78 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>
Date: Wed, 13 Jul 2016 10:21:24 +0200
Subject: [PATCH] Properly escape partition removal query
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Michal Čihař <michal@cihar.com>
---
 templates/table/structure/display_structure.phtml |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/templates/table/structure/display_structure.phtml b/templates/table/structure/display_structure.phtml
index ceece39..1cb3391 100644
--- a/templates/table/structure/display_structure.phtml
+++ b/templates/table/structure/display_structure.phtml
@@ -186,7 +186,7 @@ $rownum = 0; $odd_row = true; ?>
         $tmp_partition_description = $firstPartition->getDescription();
 
         $removeSQL = "ALTER TABLE " . Util::backquote($table) . " REMOVE PARTITIONING";
-        $removeUrl = 'sql.php' . $url_query . '&sql_query=' . urldecode($removeSQL);
+        $removeUrl = 'sql.php' . $url_query . '&sql_query=' . urlencode($removeSQL);
 
         echo Template::get('table/structure/display_partitions')->render(
             array(
@@ -222,4 +222,4 @@ $rownum = 0; $odd_row = true; ?>
 <?php if ($GLOBALS['cfg']['ShowStats']): ?>
     <?= $tablestats;  ?>
 <?php endif; ?>
-<div class="clearfloat"></div>
\ No newline at end of file
+<div class="clearfloat"></div>
-- 
1.7.9.5

