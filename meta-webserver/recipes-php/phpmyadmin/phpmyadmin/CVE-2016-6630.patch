From c90967071a3f43c7b53315c2595277748c1b4bed Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>
Date: Tue, 26 Jul 2016 17:02:58 +0200
Subject: [PATCH] Do not allow to set too long password
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

We do not accept password longer than 256 chars, so do not accept it on
password change as well.

Signed-off-by: Michal Čihař <michal@cihar.com>
---
 user_password.php |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/user_password.php b/user_password.php
index 6404623..a68f3a8 100644
--- a/user_password.php
+++ b/user_password.php
@@ -120,6 +120,9 @@ function PMA_setChangePasswordMsg()
                 __('The passwords aren\'t the same!')
             );
             $error = true;
+        } elseif (strlen($_REQUEST['pma_pw']) > 256) {
+            $message = PMA_Message::error(__('Password is too long!'));
+            $error = true;
         }
     }
     return array('error' => $error, 'msg' => $message);
-- 
1.7.9.5

