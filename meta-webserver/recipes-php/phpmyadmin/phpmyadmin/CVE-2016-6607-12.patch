From 9e3492730ebf6d60dafd0283f605c6ad09f8271a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>
Date: Wed, 13 Jul 2016 10:27:43 +0200
Subject: [PATCH] Do not use empty MIME type
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This will turn on content sniffing in browser leading to unwanted
results.

Signed-off-by: Michal Čihař <michal@cihar.com>
---
 transformation_wrapper.php |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/transformation_wrapper.php b/transformation_wrapper.php
index 8240a06..48ae3a0 100644
--- a/transformation_wrapper.php
+++ b/transformation_wrapper.php
@@ -102,7 +102,7 @@ $response->getHeader()->sendHttpHeaders();
 if (isset($ct) && ! empty($ct)) {
     $mime_type = $ct;
 } else {
-    $mime_type = (isset($mime_map[$transform_key]['mimetype'])
+    $mime_type = (!empty($mime_map[$transform_key]['mimetype'])
         ? str_replace('_', '/', $mime_map[$transform_key]['mimetype'])
         : $default_ct)
     . (isset($mime_options['charset']) ? $mime_options['charset'] : '');
-- 
1.7.9.5

