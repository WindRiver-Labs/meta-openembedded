From cbba4f4fdb18ad071e3d515a0e96067939d3352b Mon Sep 17 00:00:00 2001
From: Madhura Jayaratne <madhura.cj@gmail.com>
Date: Tue, 12 Jul 2016 11:49:53 +1000
Subject: [PATCH] Fix XSS in server_replication.php

Signed-off-by: Madhura Jayaratne <madhura.cj@gmail.com>
---
 libraries/replication_gui.lib.php |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/libraries/replication_gui.lib.php b/libraries/replication_gui.lib.php
index d0d5dd2..3cda349 100644
--- a/libraries/replication_gui.lib.php
+++ b/libraries/replication_gui.lib.php
@@ -806,7 +806,7 @@ function PMA_getHtmlForAddUserLoginForm($username_length)
         . (empty($_REQUEST['username']) ? '' : ' value="'
         . (isset($GLOBALS['new_username'])
             ? $GLOBALS['new_username']
-            : $_REQUEST['username']) . '"')
+            : htmlspecialchars($_REQUEST['username'])) . '"')
         . ' />'
         . '</div>';
 
@@ -836,7 +836,7 @@ function PMA_getHtmlForTableInfoForm($hostname_length)
         . '</span>'
         . '<input type="text" name="hostname" id="pma_hostname" maxlength="'
         . $hostname_length . '" value="'
-        . (isset($_REQUEST['hostname']) ? $_REQUEST['hostname'] : '')
+        . (isset($_REQUEST['hostname']) ? htmlspecialchars($_REQUEST['hostname']) : '')
         . '" title="' . __('Host')
         . '" />'
         . PMA\libraries\Util::showHint(
-- 
1.7.9.5

