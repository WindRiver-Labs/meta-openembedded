From 61976131350eca8cbba74270a44ea7baa708259f Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>
Date: Thu, 18 Aug 2016 09:48:51 +0200
Subject: [PATCH] Silent errors when getting remote file
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

- both curl and fopen wrappers can emmit errors in cases where remote
  site is not accessible
- do not pass false value to json_decode

Signed-off-by: Michal Čihař <michal@cihar.com>
---
 libraries/VersionInformation.php |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/libraries/VersionInformation.php b/libraries/VersionInformation.php
index a49a1b9..26e46d0 100644
--- a/libraries/VersionInformation.php
+++ b/libraries/VersionInformation.php
@@ -59,7 +59,7 @@ class VersionInformation
                 if (! defined('TESTSUITE')) {
                     session_write_close();
                 }
-                $response = file_get_contents(
+                $response = @file_get_contents(
                     $file,
                     false,
                     stream_context_create($context)
@@ -88,7 +88,11 @@ class VersionInformation
                 if (! defined('TESTSUITE')) {
                     session_write_close();
                 }
-                $response = curl_exec($curl_handle);
+                $response = @curl_exec($curl_handle);
+            }
+            // Check possible failure of getting data
+            if ($response === false) {
+                $response = '{}';
             }
         }
 
-- 
1.7.9.5

